-- -*- mode: SQL -*-

-- View: billing_events.vw_fact_billing_events_detail_hdfs

-- DROP VIEW billing_events.vw_fact_billing_events_detail_hdfs;

CREATE OR REPLACE VIEW billing_events.vw_fact_billing_events_detail_hdfs AS 
       (        (        (        (        (         SELECT i.time_full_date AS event_start_date_time_full_date, i.time_day_number AS event_start_date_time_day_number, i.time_day_of_week AS event_start_date_time_day_of_week, i.time_month_number AS event_start_date_time_month_number, i.time_month_desc AS event_start_date_time_month_desc, i.time_month_abbr AS event_start_date_time_month_abbr, i.time_year_number AS event_start_date_time_year_number, i.time_quarter_number AS event_start_date_time_quarter_number, i.time_quarter_desc AS event_start_date_time_quarter_desc, i.time_business_day_number AS event_start_date_time_business_day_number, i.time_year_month_key AS event_start_date_time_year_month_key, i.time_last_day_month_flag AS event_start_date_time_last_day_month_flag, i.time_week_year_number AS event_start_date_time_week_year_number, i.time_week_month_number AS event_start_date_time_week_month_number, i.time_day_yr AS event_start_date_time_day_yr, i.time_day_week AS event_start_date_time_day_week, k.time_full_date AS event_end_date_time_full_date, k.time_day_number AS event_end_date_time_day_number, k.time_day_of_week AS event_end_date_time_day_of_week, k.time_month_number AS event_end_date_time_month_number, k.time_month_desc AS event_end_date_time_month_desc, k.time_month_abbr AS event_end_date_time_month_abbr, k.time_year_number AS event_end_date_time_year_number, k.time_quarter_number AS event_end_date_time_quarter_number, k.time_quarter_desc AS event_end_date_time_quarter_desc, k.time_business_day_number AS event_end_date_time_business_day_number, k.time_year_month_key AS event_end_date_time_year_month_key, k.time_last_day_month_flag AS event_end_date_time_last_day_month_flag, k.time_week_year_number AS event_end_date_time_week_year_number, k.time_week_month_number AS event_end_date_time_week_month_number, k.time_day_yr AS event_end_date_time_day_yr, k.time_day_week AS event_end_date_time_day_week, j.time_full_date AS invoice_date_time_full_date, j.time_day_number AS invoice_date_time_day_number, j.time_day_of_week AS invoice_date_time_day_of_week, j.time_month_number AS invoice_date_time_month_number, j.time_month_desc AS invoice_date_time_month_desc, j.time_month_abbr AS invoice_date_time_month_abbr, j.time_year_number AS invoice_date_time_year_number, j.time_quarter_number AS invoice_date_time_quarter_number, j.time_quarter_desc AS invoice_date_time_quarter_desc, j.time_business_day_number AS invoice_date_time_business_day_number, j.time_year_month_key AS invoice_date_time_year_month_key, j.time_last_day_month_flag AS invoice_date_time_last_day_month_flag, j.time_week_year_number AS invoice_date_time_week_year_number, j.time_week_month_number AS invoice_date_time_week_month_number, j.time_day_yr AS invoice_date_time_day_yr, j.time_day_week AS invoice_date_time_day_week, e.hms_time AS event_start_date_hms_time, e.hms_military_hour_number AS event_start_date_hms_military_hour_number, e.hms_standard_hour_number AS event_start_date_hms_standard_hour_number, e.hms_minute_number AS event_start_date_hms_minute_number, e.hms_second_number AS event_start_date_hms_second_number, e.hms_standard AS event_start_date_hms_standard, e.hms_shift_number AS event_start_date_hms_shift_number, ee.hms_time AS event_end_date_hms_time, ee.hms_military_hour_number AS event_end_date_hms_military_hour_number, ee.hms_standard_hour_number AS event_end_date_hms_standard_hour_number, ee.hms_minute_number AS event_end_date_hms_minute_number, ee.hms_second_number AS event_end_date_hms_second_number, ee.hms_standard AS event_end_date_hms_standard, ee.hms_shift_number AS event_end_date_hms_shift_number, b.account_caption, b.account_id, b.account_name, b.account_number, b.account_type, b.account_type_desc, b.account_status_id, b.account_status, b.account_status_desc, b.account_sla_type, b.account_sla_type_desc, b.account_business_type_id, b.account_business_type, b.account_business_type_desc, b.account_team_name, b.account_manager_contact_id, b.account_manager, b.account_bdc_contact_id, b.account_bdc, b.account_primary_contact_id, b.account_primary_contact, b.account_first_server_online, b.account_tenure_days, b.account_backup_device_count, b.account_storage_device_count, b.account_other_network_device_count, b.account_server_count, b.account_unknown_device_count, b.account_all_device_count, b.account_region, b.account_geographic_location, b.account_subscription_amount, b.account_emer_instr_exists, b.account_created_date, b.account_nk, b.account_billing_street, b.account_billing_city, b.account_billing_state, b.account_billing_postal_code, b.account_billing_country, b.account_shipping_street, b.account_shipping_city, b.account_shipping_state, b.account_shipping_postal_code, b.account_shipping_country, b.account_phone, b.account_fax, b.account_website, b.account_sic, b.account_customer_type, b.account_annual_revenue, b.account_number_of_employees, b.account_ownership, b.account_ticker_symbol, b.account_description, b.account_rating, b.account_site, b.account_currency_iso_code, b.account_owner_id, b.account_source_system_name, b.account_executive_sponsor, b.account_sub_type, b.account_do_not_call, b.account_do_not_email, b.account_do_not_mail, b.account_ispartner, b.account_high_profile_flag, b.account_has_unmetered_backup, b.account_is_parent, b.account_parent_id, b.account_promotion_code, b.account_comped_flag, b.account_last_billed_date, b.account_desired_billing_day, b.customer_number, b.account_service_level, b.account_type_level2, b.account_bizspark_flag, b.account_lead_tech, b.cross_platform_lead_tech, b.account_service_level_name, b.account_service_type, b.account_service_level_datetime, f.product_usage_ssk, f.product_usage_nk, f.rate_tag AS product_usage_rate_tag, f.product_usage_name_by_tag, f.product_usage_type, f.product_usage_obj_type, f.account_obj_type, f.product_usage_name, f.product_usage_code, f.product_usage_description, f.product_usage_permitted, f.item_type, f.item_gl_segment, f.product_usage_creation_date, f.product_usage_updated_date, f.source_system_name AS product_source_system_name, c.instance_nk, c.instance_type, c.assigned_instance_number, c.assigned_account_number, c.instance_name, c.instance_description, c.instance_status, c.instance_datacenter, c.instance_creation_date, c.instance_updated_date, c.source_system_name AS instance_source_system_name, c.extended_table_name AS instance_extended_table_name, d.server_host_name AS instance_extended_server_host_name, d.server_flavor AS instance_extended_server_flavor, d.server_options AS instance_extended_server_options, d.managed_flag AS instance_extended_managed_flag, d.backup_flag AS instance_extended_backup_flag, d.cpu_count AS instance_extended_cpu_count, d.cpu_core_count AS instance_extended_cpu_core_count, d.ram_amount AS instance_extended_ram_amount, d.storage_amount AS instance_extended_storage_amount, d.bandwidth_amount AS instance_extended_bandwidth_amount, d.unit_amount AS instance_extended_unit_amount, d.operating_system AS instance_extended_operating_system, d.database_option AS instance_extended_database_option, d.created_date AS instance_extended_created_date, d.updated_date AS instance_extended_updated_date, d.source_system_name AS instance_extended_source_system_name, h.team_id, h.team_name, h.team_description, h.team_report_header, h.team_role_id, h.team_active, h.team_data_source, h.team_business_segment, h.team_business_sub_segment, h.team_company, h.team_division, g.source_system_name, l.unit_of_measure_name AS local_currency_name, l.unit_of_measure_description AS local_currency_decription, l.unit_of_measure_abbreviation AS local_currency_abbreviation, m.unit_of_measure_name AS bandwidth_unit_of_measure_name, m.unit_of_measure_description AS bandwidth_unit_of_measure_decription, a.brm_ssk, a.usl_ssk, a.dollar_amount, a.local_currency, a.quantity, a.start_time_key
                                                  FROM billing_events.fact_billing_events_detail_201408 a
                                             JOIN dim_repo.dim_account b ON a.account_key = b.account_key
                                        JOIN dim_repo.dim_instance c ON a.instance_key = c.instance_key
                                   JOIN dim_repo.dim_extended_cloud_server d ON a.extended_instance_key = d.extended_key
                              JOIN dim_repo.dim_hour_min_sec e ON a.start_hms_key = e.hms_key
                         JOIN dim_repo.dim_hour_min_sec ee ON a.end_hms_key = ee.hms_key
                    JOIN dim_repo.dim_product_usage f ON a.product_usage_key::numeric = f.product_usage_key
               JOIN dim_repo.dim_source_system g ON a.source_system_key = g.source_system_key
          JOIN dim_repo.dim_team h ON a.team_key = h.team_key
     JOIN dim_repo.dim_time i ON a.start_time_key = i.time_key
  JOIN dim_repo.dim_time j ON a.billing_cycle_dom_key = j.time_key
  JOIN dim_repo.dim_time k ON a.end_time_key = k.time_key
  JOIN dim_repo.dim_unit_of_measure l ON a.uom_currency_type_key = l.unit_of_measure_key
  JOIN dim_repo.dim_unit_of_measure m ON a.uom_bandwidth_key = m.unit_of_measure_key
                                       UNION ALL 
                                                SELECT i.time_full_date AS event_start_date_time_full_date, i.time_day_number AS event_start_date_time_day_number, i.time_day_of_week AS event_start_date_time_day_of_week, i.time_month_number AS event_start_date_time_month_number, i.time_month_desc AS event_start_date_time_month_desc, i.time_month_abbr AS event_start_date_time_month_abbr, i.time_year_number AS event_start_date_time_year_number, i.time_quarter_number AS event_start_date_time_quarter_number, i.time_quarter_desc AS event_start_date_time_quarter_desc, i.time_business_day_number AS event_start_date_time_business_day_number, i.time_year_month_key AS event_start_date_time_year_month_key, i.time_last_day_month_flag AS event_start_date_time_last_day_month_flag, i.time_week_year_number AS event_start_date_time_week_year_number, i.time_week_month_number AS event_start_date_time_week_month_number, i.time_day_yr AS event_start_date_time_day_yr, i.time_day_week AS event_start_date_time_day_week, k.time_full_date AS event_end_date_time_full_date, k.time_day_number AS event_end_date_time_day_number, k.time_day_of_week AS event_end_date_time_day_of_week, k.time_month_number AS event_end_date_time_month_number, k.time_month_desc AS event_end_date_time_month_desc, k.time_month_abbr AS event_end_date_time_month_abbr, k.time_year_number AS event_end_date_time_year_number, k.time_quarter_number AS event_end_date_time_quarter_number, k.time_quarter_desc AS event_end_date_time_quarter_desc, k.time_business_day_number AS event_end_date_time_business_day_number, k.time_year_month_key AS event_end_date_time_year_month_key, k.time_last_day_month_flag AS event_end_date_time_last_day_month_flag, k.time_week_year_number AS event_end_date_time_week_year_number, k.time_week_month_number AS event_end_date_time_week_month_number, k.time_day_yr AS event_end_date_time_day_yr, k.time_day_week AS event_end_date_time_day_week, j.time_full_date AS invoice_date_time_full_date, j.time_day_number AS invoice_date_time_day_number, j.time_day_of_week AS invoice_date_time_day_of_week, j.time_month_number AS invoice_date_time_month_number, j.time_month_desc AS invoice_date_time_month_desc, j.time_month_abbr AS invoice_date_time_month_abbr, j.time_year_number AS invoice_date_time_year_number, j.time_quarter_number AS invoice_date_time_quarter_number, j.time_quarter_desc AS invoice_date_time_quarter_desc, j.time_business_day_number AS invoice_date_time_business_day_number, j.time_year_month_key AS invoice_date_time_year_month_key, j.time_last_day_month_flag AS invoice_date_time_last_day_month_flag, j.time_week_year_number AS invoice_date_time_week_year_number, j.time_week_month_number AS invoice_date_time_week_month_number, j.time_day_yr AS invoice_date_time_day_yr, j.time_day_week AS invoice_date_time_day_week, e.hms_time AS event_start_date_hms_time, e.hms_military_hour_number AS event_start_date_hms_military_hour_number, e.hms_standard_hour_number AS event_start_date_hms_standard_hour_number, e.hms_minute_number AS event_start_date_hms_minute_number, e.hms_second_number AS event_start_date_hms_second_number, e.hms_standard AS event_start_date_hms_standard, e.hms_shift_number AS event_start_date_hms_shift_number, ee.hms_time AS event_end_date_hms_time, ee.hms_military_hour_number AS event_end_date_hms_military_hour_number, ee.hms_standard_hour_number AS event_end_date_hms_standard_hour_number, ee.hms_minute_number AS event_end_date_hms_minute_number, ee.hms_second_number AS event_end_date_hms_second_number, ee.hms_standard AS event_end_date_hms_standard, ee.hms_shift_number AS event_end_date_hms_shift_number, b.account_caption, b.account_id, b.account_name, b.account_number, b.account_type, b.account_type_desc, b.account_status_id, b.account_status, b.account_status_desc, b.account_sla_type, b.account_sla_type_desc, b.account_business_type_id, b.account_business_type, b.account_business_type_desc, b.account_team_name, b.account_manager_contact_id, b.account_manager, b.account_bdc_contact_id, b.account_bdc, b.account_primary_contact_id, b.account_primary_contact, b.account_first_server_online, b.account_tenure_days, b.account_backup_device_count, b.account_storage_device_count, b.account_other_network_device_count, b.account_server_count, b.account_unknown_device_count, b.account_all_device_count, b.account_region, b.account_geographic_location, b.account_subscription_amount, b.account_emer_instr_exists, b.account_created_date, b.account_nk, b.account_billing_street, b.account_billing_city, b.account_billing_state, b.account_billing_postal_code, b.account_billing_country, b.account_shipping_street, b.account_shipping_city, b.account_shipping_state, b.account_shipping_postal_code, b.account_shipping_country, b.account_phone, b.account_fax, b.account_website, b.account_sic, b.account_customer_type, b.account_annual_revenue, b.account_number_of_employees, b.account_ownership, b.account_ticker_symbol, b.account_description, b.account_rating, b.account_site, b.account_currency_iso_code, b.account_owner_id, b.account_source_system_name, b.account_executive_sponsor, b.account_sub_type, b.account_do_not_call, b.account_do_not_email, b.account_do_not_mail, b.account_ispartner, b.account_high_profile_flag, b.account_has_unmetered_backup, b.account_is_parent, b.account_parent_id, b.account_promotion_code, b.account_comped_flag, b.account_last_billed_date, b.account_desired_billing_day, b.customer_number, b.account_service_level, b.account_type_level2, b.account_bizspark_flag, b.account_lead_tech, b.cross_platform_lead_tech, b.account_service_level_name, b.account_service_type, b.account_service_level_datetime, f.product_usage_ssk, f.product_usage_nk, f.rate_tag AS product_usage_rate_tag, f.product_usage_name_by_tag, f.product_usage_type, f.product_usage_obj_type, f.account_obj_type, f.product_usage_name, f.product_usage_code, f.product_usage_description, f.product_usage_permitted, f.item_type, f.item_gl_segment, f.product_usage_creation_date, f.product_usage_updated_date, f.source_system_name AS product_source_system_name, c.instance_nk, c.instance_type, c.assigned_instance_number, c.assigned_account_number, c.instance_name, c.instance_description, c.instance_status, c.instance_datacenter, c.instance_creation_date, c.instance_updated_date, c.source_system_name AS instance_source_system_name, c.extended_table_name AS instance_extended_table_name, d.server_host_name AS instance_extended_server_host_name, d.server_flavor AS instance_extended_server_flavor, d.server_options AS instance_extended_server_options, d.managed_flag AS instance_extended_managed_flag, d.backup_flag AS instance_extended_backup_flag, d.cpu_count AS instance_extended_cpu_count, d.cpu_core_count AS instance_extended_cpu_core_count, d.ram_amount AS instance_extended_ram_amount, d.storage_amount AS instance_extended_storage_amount, d.bandwidth_amount AS instance_extended_bandwidth_amount, d.unit_amount AS instance_extended_unit_amount, d.operating_system AS instance_extended_operating_system, d.database_option AS instance_extended_database_option, d.created_date AS instance_extended_created_date, d.updated_date AS instance_extended_updated_date, d.source_system_name AS instance_extended_source_system_name, h.team_id, h.team_name, h.team_description, h.team_report_header, h.team_role_id, h.team_active, h.team_data_source, h.team_business_segment, h.team_business_sub_segment, h.team_company, h.team_division, g.source_system_name, l.unit_of_measure_name AS local_currency_name, l.unit_of_measure_description AS local_currency_decription, l.unit_of_measure_abbreviation AS local_currency_abbreviation, m.unit_of_measure_name AS bandwidth_unit_of_measure_name, m.unit_of_measure_description AS bandwidth_unit_of_measure_decription, a.brm_ssk, a.usl_ssk, a.dollar_amount, a.local_currency, a.quantity, a.start_time_key
                                                  FROM billing_events.fact_billing_events_detail_201407 a
                                             JOIN dim_repo.dim_account b ON a.account_key = b.account_key
                                        JOIN dim_repo.dim_instance c ON a.instance_key = c.instance_key
                                   JOIN dim_repo.dim_extended_cloud_server d ON a.extended_instance_key = d.extended_key
                              JOIN dim_repo.dim_hour_min_sec e ON a.start_hms_key = e.hms_key
                         JOIN dim_repo.dim_hour_min_sec ee ON a.end_hms_key = ee.hms_key
                    JOIN dim_repo.dim_product_usage f ON a.product_usage_key::numeric = f.product_usage_key
               JOIN dim_repo.dim_source_system g ON a.source_system_key = g.source_system_key
          JOIN dim_repo.dim_team h ON a.team_key = h.team_key
     JOIN dim_repo.dim_time i ON a.start_time_key = i.time_key
  JOIN dim_repo.dim_time j ON a.billing_cycle_dom_key = j.time_key
  JOIN dim_repo.dim_time k ON a.end_time_key = k.time_key
  JOIN dim_repo.dim_unit_of_measure l ON a.uom_currency_type_key = l.unit_of_measure_key
  JOIN dim_repo.dim_unit_of_measure m ON a.uom_bandwidth_key = m.unit_of_measure_key)
                               UNION ALL 
                                        SELECT i.time_full_date AS event_start_date_time_full_date, i.time_day_number AS event_start_date_time_day_number, i.time_day_of_week AS event_start_date_time_day_of_week, i.time_month_number AS event_start_date_time_month_number, i.time_month_desc AS event_start_date_time_month_desc, i.time_month_abbr AS event_start_date_time_month_abbr, i.time_year_number AS event_start_date_time_year_number, i.time_quarter_number AS event_start_date_time_quarter_number, i.time_quarter_desc AS event_start_date_time_quarter_desc, i.time_business_day_number AS event_start_date_time_business_day_number, i.time_year_month_key AS event_start_date_time_year_month_key, i.time_last_day_month_flag AS event_start_date_time_last_day_month_flag, i.time_week_year_number AS event_start_date_time_week_year_number, i.time_week_month_number AS event_start_date_time_week_month_number, i.time_day_yr AS event_start_date_time_day_yr, i.time_day_week AS event_start_date_time_day_week, k.time_full_date AS event_end_date_time_full_date, k.time_day_number AS event_end_date_time_day_number, k.time_day_of_week AS event_end_date_time_day_of_week, k.time_month_number AS event_end_date_time_month_number, k.time_month_desc AS event_end_date_time_month_desc, k.time_month_abbr AS event_end_date_time_month_abbr, k.time_year_number AS event_end_date_time_year_number, k.time_quarter_number AS event_end_date_time_quarter_number, k.time_quarter_desc AS event_end_date_time_quarter_desc, k.time_business_day_number AS event_end_date_time_business_day_number, k.time_year_month_key AS event_end_date_time_year_month_key, k.time_last_day_month_flag AS event_end_date_time_last_day_month_flag, k.time_week_year_number AS event_end_date_time_week_year_number, k.time_week_month_number AS event_end_date_time_week_month_number, k.time_day_yr AS event_end_date_time_day_yr, k.time_day_week AS event_end_date_time_day_week, j.time_full_date AS invoice_date_time_full_date, j.time_day_number AS invoice_date_time_day_number, j.time_day_of_week AS invoice_date_time_day_of_week, j.time_month_number AS invoice_date_time_month_number, j.time_month_desc AS invoice_date_time_month_desc, j.time_month_abbr AS invoice_date_time_month_abbr, j.time_year_number AS invoice_date_time_year_number, j.time_quarter_number AS invoice_date_time_quarter_number, j.time_quarter_desc AS invoice_date_time_quarter_desc, j.time_business_day_number AS invoice_date_time_business_day_number, j.time_year_month_key AS invoice_date_time_year_month_key, j.time_last_day_month_flag AS invoice_date_time_last_day_month_flag, j.time_week_year_number AS invoice_date_time_week_year_number, j.time_week_month_number AS invoice_date_time_week_month_number, j.time_day_yr AS invoice_date_time_day_yr, j.time_day_week AS invoice_date_time_day_week, e.hms_time AS event_start_date_hms_time, e.hms_military_hour_number AS event_start_date_hms_military_hour_number, e.hms_standard_hour_number AS event_start_date_hms_standard_hour_number, e.hms_minute_number AS event_start_date_hms_minute_number, e.hms_second_number AS event_start_date_hms_second_number, e.hms_standard AS event_start_date_hms_standard, e.hms_shift_number AS event_start_date_hms_shift_number, ee.hms_time AS event_end_date_hms_time, ee.hms_military_hour_number AS event_end_date_hms_military_hour_number, ee.hms_standard_hour_number AS event_end_date_hms_standard_hour_number, ee.hms_minute_number AS event_end_date_hms_minute_number, ee.hms_second_number AS event_end_date_hms_second_number, ee.hms_standard AS event_end_date_hms_standard, ee.hms_shift_number AS event_end_date_hms_shift_number, b.account_caption, b.account_id, b.account_name, b.account_number, b.account_type, b.account_type_desc, b.account_status_id, b.account_status, b.account_status_desc, b.account_sla_type, b.account_sla_type_desc, b.account_business_type_id, b.account_business_type, b.account_business_type_desc, b.account_team_name, b.account_manager_contact_id, b.account_manager, b.account_bdc_contact_id, b.account_bdc, b.account_primary_contact_id, b.account_primary_contact, b.account_first_server_online, b.account_tenure_days, b.account_backup_device_count, b.account_storage_device_count, b.account_other_network_device_count, b.account_server_count, b.account_unknown_device_count, b.account_all_device_count, b.account_region, b.account_geographic_location, b.account_subscription_amount, b.account_emer_instr_exists, b.account_created_date, b.account_nk, b.account_billing_street, b.account_billing_city, b.account_billing_state, b.account_billing_postal_code, b.account_billing_country, b.account_shipping_street, b.account_shipping_city, b.account_shipping_state, b.account_shipping_postal_code, b.account_shipping_country, b.account_phone, b.account_fax, b.account_website, b.account_sic, b.account_customer_type, b.account_annual_revenue, b.account_number_of_employees, b.account_ownership, b.account_ticker_symbol, b.account_description, b.account_rating, b.account_site, b.account_currency_iso_code, b.account_owner_id, b.account_source_system_name, b.account_executive_sponsor, b.account_sub_type, b.account_do_not_call, b.account_do_not_email, b.account_do_not_mail, b.account_ispartner, b.account_high_profile_flag, b.account_has_unmetered_backup, b.account_is_parent, b.account_parent_id, b.account_promotion_code, b.account_comped_flag, b.account_last_billed_date, b.account_desired_billing_day, b.customer_number, b.account_service_level, b.account_type_level2, b.account_bizspark_flag, b.account_lead_tech, b.cross_platform_lead_tech, b.account_service_level_name, b.account_service_type, b.account_service_level_datetime, f.product_usage_ssk, f.product_usage_nk, f.rate_tag AS product_usage_rate_tag, f.product_usage_name_by_tag, f.product_usage_type, f.product_usage_obj_type, f.account_obj_type, f.product_usage_name, f.product_usage_code, f.product_usage_description, f.product_usage_permitted, f.item_type, f.item_gl_segment, f.product_usage_creation_date, f.product_usage_updated_date, f.source_system_name AS product_source_system_name, c.instance_nk, c.instance_type, c.assigned_instance_number, c.assigned_account_number, c.instance_name, c.instance_description, c.instance_status, c.instance_datacenter, c.instance_creation_date, c.instance_updated_date, c.source_system_name AS instance_source_system_name, c.extended_table_name AS instance_extended_table_name, d.server_host_name AS instance_extended_server_host_name, d.server_flavor AS instance_extended_server_flavor, d.server_options AS instance_extended_server_options, d.managed_flag AS instance_extended_managed_flag, d.backup_flag AS instance_extended_backup_flag, d.cpu_count AS instance_extended_cpu_count, d.cpu_core_count AS instance_extended_cpu_core_count, d.ram_amount AS instance_extended_ram_amount, d.storage_amount AS instance_extended_storage_amount, d.bandwidth_amount AS instance_extended_bandwidth_amount, d.unit_amount AS instance_extended_unit_amount, d.operating_system AS instance_extended_operating_system, d.database_option AS instance_extended_database_option, d.created_date AS instance_extended_created_date, d.updated_date AS instance_extended_updated_date, d.source_system_name AS instance_extended_source_system_name, h.team_id, h.team_name, h.team_description, h.team_report_header, h.team_role_id, h.team_active, h.team_data_source, h.team_business_segment, h.team_business_sub_segment, h.team_company, h.team_division, g.source_system_name, l.unit_of_measure_name AS local_currency_name, l.unit_of_measure_description AS local_currency_decription, l.unit_of_measure_abbreviation AS local_currency_abbreviation, m.unit_of_measure_name AS bandwidth_unit_of_measure_name, m.unit_of_measure_description AS bandwidth_unit_of_measure_decription, a.brm_ssk, a.usl_ssk, a.dollar_amount, a.local_currency, a.quantity, a.start_time_key
                                          FROM billing_events.fact_billing_events_detail_201406 a
                                     JOIN dim_repo.dim_account b ON a.account_key = b.account_key
                                JOIN dim_repo.dim_instance c ON a.instance_key = c.instance_key
                           JOIN dim_repo.dim_extended_cloud_server d ON a.extended_instance_key = d.extended_key
                      JOIN dim_repo.dim_hour_min_sec e ON a.start_hms_key = e.hms_key
                 JOIN dim_repo.dim_hour_min_sec ee ON a.end_hms_key = ee.hms_key
            JOIN dim_repo.dim_product_usage f ON a.product_usage_key::numeric = f.product_usage_key
       JOIN dim_repo.dim_source_system g ON a.source_system_key = g.source_system_key
  JOIN dim_repo.dim_team h ON a.team_key = h.team_key
  JOIN dim_repo.dim_time i ON a.start_time_key = i.time_key
  JOIN dim_repo.dim_time j ON a.billing_cycle_dom_key = j.time_key
  JOIN dim_repo.dim_time k ON a.end_time_key = k.time_key
  JOIN dim_repo.dim_unit_of_measure l ON a.uom_currency_type_key = l.unit_of_measure_key
  JOIN dim_repo.dim_unit_of_measure m ON a.uom_bandwidth_key = m.unit_of_measure_key)
                       UNION ALL 
                                SELECT i.time_full_date AS event_start_date_time_full_date, i.time_day_number AS event_start_date_time_day_number, i.time_day_of_week AS event_start_date_time_day_of_week, i.time_month_number AS event_start_date_time_month_number, i.time_month_desc AS event_start_date_time_month_desc, i.time_month_abbr AS event_start_date_time_month_abbr, i.time_year_number AS event_start_date_time_year_number, i.time_quarter_number AS event_start_date_time_quarter_number, i.time_quarter_desc AS event_start_date_time_quarter_desc, i.time_business_day_number AS event_start_date_time_business_day_number, i.time_year_month_key AS event_start_date_time_year_month_key, i.time_last_day_month_flag AS event_start_date_time_last_day_month_flag, i.time_week_year_number AS event_start_date_time_week_year_number, i.time_week_month_number AS event_start_date_time_week_month_number, i.time_day_yr AS event_start_date_time_day_yr, i.time_day_week AS event_start_date_time_day_week, k.time_full_date AS event_end_date_time_full_date, k.time_day_number AS event_end_date_time_day_number, k.time_day_of_week AS event_end_date_time_day_of_week, k.time_month_number AS event_end_date_time_month_number, k.time_month_desc AS event_end_date_time_month_desc, k.time_month_abbr AS event_end_date_time_month_abbr, k.time_year_number AS event_end_date_time_year_number, k.time_quarter_number AS event_end_date_time_quarter_number, k.time_quarter_desc AS event_end_date_time_quarter_desc, k.time_business_day_number AS event_end_date_time_business_day_number, k.time_year_month_key AS event_end_date_time_year_month_key, k.time_last_day_month_flag AS event_end_date_time_last_day_month_flag, k.time_week_year_number AS event_end_date_time_week_year_number, k.time_week_month_number AS event_end_date_time_week_month_number, k.time_day_yr AS event_end_date_time_day_yr, k.time_day_week AS event_end_date_time_day_week, j.time_full_date AS invoice_date_time_full_date, j.time_day_number AS invoice_date_time_day_number, j.time_day_of_week AS invoice_date_time_day_of_week, j.time_month_number AS invoice_date_time_month_number, j.time_month_desc AS invoice_date_time_month_desc, j.time_month_abbr AS invoice_date_time_month_abbr, j.time_year_number AS invoice_date_time_year_number, j.time_quarter_number AS invoice_date_time_quarter_number, j.time_quarter_desc AS invoice_date_time_quarter_desc, j.time_business_day_number AS invoice_date_time_business_day_number, j.time_year_month_key AS invoice_date_time_year_month_key, j.time_last_day_month_flag AS invoice_date_time_last_day_month_flag, j.time_week_year_number AS invoice_date_time_week_year_number, j.time_week_month_number AS invoice_date_time_week_month_number, j.time_day_yr AS invoice_date_time_day_yr, j.time_day_week AS invoice_date_time_day_week, e.hms_time AS event_start_date_hms_time, e.hms_military_hour_number AS event_start_date_hms_military_hour_number, e.hms_standard_hour_number AS event_start_date_hms_standard_hour_number, e.hms_minute_number AS event_start_date_hms_minute_number, e.hms_second_number AS event_start_date_hms_second_number, e.hms_standard AS event_start_date_hms_standard, e.hms_shift_number AS event_start_date_hms_shift_number, ee.hms_time AS event_end_date_hms_time, ee.hms_military_hour_number AS event_end_date_hms_military_hour_number, ee.hms_standard_hour_number AS event_end_date_hms_standard_hour_number, ee.hms_minute_number AS event_end_date_hms_minute_number, ee.hms_second_number AS event_end_date_hms_second_number, ee.hms_standard AS event_end_date_hms_standard, ee.hms_shift_number AS event_end_date_hms_shift_number, b.account_caption, b.account_id, b.account_name, b.account_number, b.account_type, b.account_type_desc, b.account_status_id, b.account_status, b.account_status_desc, b.account_sla_type, b.account_sla_type_desc, b.account_business_type_id, b.account_business_type, b.account_business_type_desc, b.account_team_name, b.account_manager_contact_id, b.account_manager, b.account_bdc_contact_id, b.account_bdc, b.account_primary_contact_id, b.account_primary_contact, b.account_first_server_online, b.account_tenure_days, b.account_backup_device_count, b.account_storage_device_count, b.account_other_network_device_count, b.account_server_count, b.account_unknown_device_count, b.account_all_device_count, b.account_region, b.account_geographic_location, b.account_subscription_amount, b.account_emer_instr_exists, b.account_created_date, b.account_nk, b.account_billing_street, b.account_billing_city, b.account_billing_state, b.account_billing_postal_code, b.account_billing_country, b.account_shipping_street, b.account_shipping_city, b.account_shipping_state, b.account_shipping_postal_code, b.account_shipping_country, b.account_phone, b.account_fax, b.account_website, b.account_sic, b.account_customer_type, b.account_annual_revenue, b.account_number_of_employees, b.account_ownership, b.account_ticker_symbol, b.account_description, b.account_rating, b.account_site, b.account_currency_iso_code, b.account_owner_id, b.account_source_system_name, b.account_executive_sponsor, b.account_sub_type, b.account_do_not_call, b.account_do_not_email, b.account_do_not_mail, b.account_ispartner, b.account_high_profile_flag, b.account_has_unmetered_backup, b.account_is_parent, b.account_parent_id, b.account_promotion_code, b.account_comped_flag, b.account_last_billed_date, b.account_desired_billing_day, b.customer_number, b.account_service_level, b.account_type_level2, b.account_bizspark_flag, b.account_lead_tech, b.cross_platform_lead_tech, b.account_service_level_name, b.account_service_type, b.account_service_level_datetime, f.product_usage_ssk, f.product_usage_nk, f.rate_tag AS product_usage_rate_tag, f.product_usage_name_by_tag, f.product_usage_type, f.product_usage_obj_type, f.account_obj_type, f.product_usage_name, f.product_usage_code, f.product_usage_description, f.product_usage_permitted, f.item_type, f.item_gl_segment, f.product_usage_creation_date, f.product_usage_updated_date, f.source_system_name AS product_source_system_name, c.instance_nk, c.instance_type, c.assigned_instance_number, c.assigned_account_number, c.instance_name, c.instance_description, c.instance_status, c.instance_datacenter, c.instance_creation_date, c.instance_updated_date, c.source_system_name AS instance_source_system_name, c.extended_table_name AS instance_extended_table_name, d.server_host_name AS instance_extended_server_host_name, d.server_flavor AS instance_extended_server_flavor, d.server_options AS instance_extended_server_options, d.managed_flag AS instance_extended_managed_flag, d.backup_flag AS instance_extended_backup_flag, d.cpu_count AS instance_extended_cpu_count, d.cpu_core_count AS instance_extended_cpu_core_count, d.ram_amount AS instance_extended_ram_amount, d.storage_amount AS instance_extended_storage_amount, d.bandwidth_amount AS instance_extended_bandwidth_amount, d.unit_amount AS instance_extended_unit_amount, d.operating_system AS instance_extended_operating_system, d.database_option AS instance_extended_database_option, d.created_date AS instance_extended_created_date, d.updated_date AS instance_extended_updated_date, d.source_system_name AS instance_extended_source_system_name, h.team_id, h.team_name, h.team_description, h.team_report_header, h.team_role_id, h.team_active, h.team_data_source, h.team_business_segment, h.team_business_sub_segment, h.team_company, h.team_division, g.source_system_name, l.unit_of_measure_name AS local_currency_name, l.unit_of_measure_description AS local_currency_decription, l.unit_of_measure_abbreviation AS local_currency_abbreviation, m.unit_of_measure_name AS bandwidth_unit_of_measure_name, m.unit_of_measure_description AS bandwidth_unit_of_measure_decription, a.brm_ssk, a.usl_ssk, a.dollar_amount, a.local_currency, a.quantity, a.start_time_key
                                  FROM billing_events.fact_billing_events_detail_201405 a
                             JOIN dim_repo.dim_account b ON a.account_key = b.account_key
                        JOIN dim_repo.dim_instance c ON a.instance_key = c.instance_key
                   JOIN dim_repo.dim_extended_cloud_server d ON a.extended_instance_key = d.extended_key
              JOIN dim_repo.dim_hour_min_sec e ON a.start_hms_key = e.hms_key
         JOIN dim_repo.dim_hour_min_sec ee ON a.end_hms_key = ee.hms_key
    JOIN dim_repo.dim_product_usage f ON a.product_usage_key::numeric = f.product_usage_key
  JOIN dim_repo.dim_source_system g ON a.source_system_key = g.source_system_key
  JOIN dim_repo.dim_team h ON a.team_key = h.team_key
  JOIN dim_repo.dim_time i ON a.start_time_key = i.time_key
  JOIN dim_repo.dim_time j ON a.billing_cycle_dom_key = j.time_key
  JOIN dim_repo.dim_time k ON a.end_time_key = k.time_key
  JOIN dim_repo.dim_unit_of_measure l ON a.uom_currency_type_key = l.unit_of_measure_key
  JOIN dim_repo.dim_unit_of_measure m ON a.uom_bandwidth_key = m.unit_of_measure_key)
               UNION ALL 
                        SELECT i.time_full_date AS event_start_date_time_full_date, i.time_day_number AS event_start_date_time_day_number, i.time_day_of_week AS event_start_date_time_day_of_week, i.time_month_number AS event_start_date_time_month_number, i.time_month_desc AS event_start_date_time_month_desc, i.time_month_abbr AS event_start_date_time_month_abbr, i.time_year_number AS event_start_date_time_year_number, i.time_quarter_number AS event_start_date_time_quarter_number, i.time_quarter_desc AS event_start_date_time_quarter_desc, i.time_business_day_number AS event_start_date_time_business_day_number, i.time_year_month_key AS event_start_date_time_year_month_key, i.time_last_day_month_flag AS event_start_date_time_last_day_month_flag, i.time_week_year_number AS event_start_date_time_week_year_number, i.time_week_month_number AS event_start_date_time_week_month_number, i.time_day_yr AS event_start_date_time_day_yr, i.time_day_week AS event_start_date_time_day_week, k.time_full_date AS event_end_date_time_full_date, k.time_day_number AS event_end_date_time_day_number, k.time_day_of_week AS event_end_date_time_day_of_week, k.time_month_number AS event_end_date_time_month_number, k.time_month_desc AS event_end_date_time_month_desc, k.time_month_abbr AS event_end_date_time_month_abbr, k.time_year_number AS event_end_date_time_year_number, k.time_quarter_number AS event_end_date_time_quarter_number, k.time_quarter_desc AS event_end_date_time_quarter_desc, k.time_business_day_number AS event_end_date_time_business_day_number, k.time_year_month_key AS event_end_date_time_year_month_key, k.time_last_day_month_flag AS event_end_date_time_last_day_month_flag, k.time_week_year_number AS event_end_date_time_week_year_number, k.time_week_month_number AS event_end_date_time_week_month_number, k.time_day_yr AS event_end_date_time_day_yr, k.time_day_week AS event_end_date_time_day_week, j.time_full_date AS invoice_date_time_full_date, j.time_day_number AS invoice_date_time_day_number, j.time_day_of_week AS invoice_date_time_day_of_week, j.time_month_number AS invoice_date_time_month_number, j.time_month_desc AS invoice_date_time_month_desc, j.time_month_abbr AS invoice_date_time_month_abbr, j.time_year_number AS invoice_date_time_year_number, j.time_quarter_number AS invoice_date_time_quarter_number, j.time_quarter_desc AS invoice_date_time_quarter_desc, j.time_business_day_number AS invoice_date_time_business_day_number, j.time_year_month_key AS invoice_date_time_year_month_key, j.time_last_day_month_flag AS invoice_date_time_last_day_month_flag, j.time_week_year_number AS invoice_date_time_week_year_number, j.time_week_month_number AS invoice_date_time_week_month_number, j.time_day_yr AS invoice_date_time_day_yr, j.time_day_week AS invoice_date_time_day_week, e.hms_time AS event_start_date_hms_time, e.hms_military_hour_number AS event_start_date_hms_military_hour_number, e.hms_standard_hour_number AS event_start_date_hms_standard_hour_number, e.hms_minute_number AS event_start_date_hms_minute_number, e.hms_second_number AS event_start_date_hms_second_number, e.hms_standard AS event_start_date_hms_standard, e.hms_shift_number AS event_start_date_hms_shift_number, ee.hms_time AS event_end_date_hms_time, ee.hms_military_hour_number AS event_end_date_hms_military_hour_number, ee.hms_standard_hour_number AS event_end_date_hms_standard_hour_number, ee.hms_minute_number AS event_end_date_hms_minute_number, ee.hms_second_number AS event_end_date_hms_second_number, ee.hms_standard AS event_end_date_hms_standard, ee.hms_shift_number AS event_end_date_hms_shift_number, b.account_caption, b.account_id, b.account_name, b.account_number, b.account_type, b.account_type_desc, b.account_status_id, b.account_status, b.account_status_desc, b.account_sla_type, b.account_sla_type_desc, b.account_business_type_id, b.account_business_type, b.account_business_type_desc, b.account_team_name, b.account_manager_contact_id, b.account_manager, b.account_bdc_contact_id, b.account_bdc, b.account_primary_contact_id, b.account_primary_contact, b.account_first_server_online, b.account_tenure_days, b.account_backup_device_count, b.account_storage_device_count, b.account_other_network_device_count, b.account_server_count, b.account_unknown_device_count, b.account_all_device_count, b.account_region, b.account_geographic_location, b.account_subscription_amount, b.account_emer_instr_exists, b.account_created_date, b.account_nk, b.account_billing_street, b.account_billing_city, b.account_billing_state, b.account_billing_postal_code, b.account_billing_country, b.account_shipping_street, b.account_shipping_city, b.account_shipping_state, b.account_shipping_postal_code, b.account_shipping_country, b.account_phone, b.account_fax, b.account_website, b.account_sic, b.account_customer_type, b.account_annual_revenue, b.account_number_of_employees, b.account_ownership, b.account_ticker_symbol, b.account_description, b.account_rating, b.account_site, b.account_currency_iso_code, b.account_owner_id, b.account_source_system_name, b.account_executive_sponsor, b.account_sub_type, b.account_do_not_call, b.account_do_not_email, b.account_do_not_mail, b.account_ispartner, b.account_high_profile_flag, b.account_has_unmetered_backup, b.account_is_parent, b.account_parent_id, b.account_promotion_code, b.account_comped_flag, b.account_last_billed_date, b.account_desired_billing_day, b.customer_number, b.account_service_level, b.account_type_level2, b.account_bizspark_flag, b.account_lead_tech, b.cross_platform_lead_tech, b.account_service_level_name, b.account_service_type, b.account_service_level_datetime, f.product_usage_ssk, f.product_usage_nk, f.rate_tag AS product_usage_rate_tag, f.product_usage_name_by_tag, f.product_usage_type, f.product_usage_obj_type, f.account_obj_type, f.product_usage_name, f.product_usage_code, f.product_usage_description, f.product_usage_permitted, f.item_type, f.item_gl_segment, f.product_usage_creation_date, f.product_usage_updated_date, f.source_system_name AS product_source_system_name, c.instance_nk, c.instance_type, c.assigned_instance_number, c.assigned_account_number, c.instance_name, c.instance_description, c.instance_status, c.instance_datacenter, c.instance_creation_date, c.instance_updated_date, c.source_system_name AS instance_source_system_name, c.extended_table_name AS instance_extended_table_name, d.server_host_name AS instance_extended_server_host_name, d.server_flavor AS instance_extended_server_flavor, d.server_options AS instance_extended_server_options, d.managed_flag AS instance_extended_managed_flag, d.backup_flag AS instance_extended_backup_flag, d.cpu_count AS instance_extended_cpu_count, d.cpu_core_count AS instance_extended_cpu_core_count, d.ram_amount AS instance_extended_ram_amount, d.storage_amount AS instance_extended_storage_amount, d.bandwidth_amount AS instance_extended_bandwidth_amount, d.unit_amount AS instance_extended_unit_amount, d.operating_system AS instance_extended_operating_system, d.database_option AS instance_extended_database_option, d.created_date AS instance_extended_created_date, d.updated_date AS instance_extended_updated_date, d.source_system_name AS instance_extended_source_system_name, h.team_id, h.team_name, h.team_description, h.team_report_header, h.team_role_id, h.team_active, h.team_data_source, h.team_business_segment, h.team_business_sub_segment, h.team_company, h.team_division, g.source_system_name, l.unit_of_measure_name AS local_currency_name, l.unit_of_measure_description AS local_currency_decription, l.unit_of_measure_abbreviation AS local_currency_abbreviation, m.unit_of_measure_name AS bandwidth_unit_of_measure_name, m.unit_of_measure_description AS bandwidth_unit_of_measure_decription, a.brm_ssk, a.usl_ssk, a.dollar_amount, a.local_currency, a.quantity, a.start_time_key
                          FROM billing_events.fact_billing_events_detail_201404 a
                     JOIN dim_repo.dim_account b ON a.account_key = b.account_key
                JOIN dim_repo.dim_instance c ON a.instance_key = c.instance_key
           JOIN dim_repo.dim_extended_cloud_server d ON a.extended_instance_key = d.extended_key
      JOIN dim_repo.dim_hour_min_sec e ON a.start_hms_key = e.hms_key
  JOIN dim_repo.dim_hour_min_sec ee ON a.end_hms_key = ee.hms_key
  JOIN dim_repo.dim_product_usage f ON a.product_usage_key::numeric = f.product_usage_key
  JOIN dim_repo.dim_source_system g ON a.source_system_key = g.source_system_key
  JOIN dim_repo.dim_team h ON a.team_key = h.team_key
  JOIN dim_repo.dim_time i ON a.start_time_key = i.time_key
  JOIN dim_repo.dim_time j ON a.billing_cycle_dom_key = j.time_key
  JOIN dim_repo.dim_time k ON a.end_time_key = k.time_key
  JOIN dim_repo.dim_unit_of_measure l ON a.uom_currency_type_key = l.unit_of_measure_key
  JOIN dim_repo.dim_unit_of_measure m ON a.uom_bandwidth_key = m.unit_of_measure_key)
       UNION ALL 
                SELECT i.time_full_date AS event_start_date_time_full_date, i.time_day_number AS event_start_date_time_day_number, i.time_day_of_week AS event_start_date_time_day_of_week, i.time_month_number AS event_start_date_time_month_number, i.time_month_desc AS event_start_date_time_month_desc, i.time_month_abbr AS event_start_date_time_month_abbr, i.time_year_number AS event_start_date_time_year_number, i.time_quarter_number AS event_start_date_time_quarter_number, i.time_quarter_desc AS event_start_date_time_quarter_desc, i.time_business_day_number AS event_start_date_time_business_day_number, i.time_year_month_key AS event_start_date_time_year_month_key, i.time_last_day_month_flag AS event_start_date_time_last_day_month_flag, i.time_week_year_number AS event_start_date_time_week_year_number, i.time_week_month_number AS event_start_date_time_week_month_number, i.time_day_yr AS event_start_date_time_day_yr, i.time_day_week AS event_start_date_time_day_week, k.time_full_date AS event_end_date_time_full_date, k.time_day_number AS event_end_date_time_day_number, k.time_day_of_week AS event_end_date_time_day_of_week, k.time_month_number AS event_end_date_time_month_number, k.time_month_desc AS event_end_date_time_month_desc, k.time_month_abbr AS event_end_date_time_month_abbr, k.time_year_number AS event_end_date_time_year_number, k.time_quarter_number AS event_end_date_time_quarter_number, k.time_quarter_desc AS event_end_date_time_quarter_desc, k.time_business_day_number AS event_end_date_time_business_day_number, k.time_year_month_key AS event_end_date_time_year_month_key, k.time_last_day_month_flag AS event_end_date_time_last_day_month_flag, k.time_week_year_number AS event_end_date_time_week_year_number, k.time_week_month_number AS event_end_date_time_week_month_number, k.time_day_yr AS event_end_date_time_day_yr, k.time_day_week AS event_end_date_time_day_week, j.time_full_date AS invoice_date_time_full_date, j.time_day_number AS invoice_date_time_day_number, j.time_day_of_week AS invoice_date_time_day_of_week, j.time_month_number AS invoice_date_time_month_number, j.time_month_desc AS invoice_date_time_month_desc, j.time_month_abbr AS invoice_date_time_month_abbr, j.time_year_number AS invoice_date_time_year_number, j.time_quarter_number AS invoice_date_time_quarter_number, j.time_quarter_desc AS invoice_date_time_quarter_desc, j.time_business_day_number AS invoice_date_time_business_day_number, j.time_year_month_key AS invoice_date_time_year_month_key, j.time_last_day_month_flag AS invoice_date_time_last_day_month_flag, j.time_week_year_number AS invoice_date_time_week_year_number, j.time_week_month_number AS invoice_date_time_week_month_number, j.time_day_yr AS invoice_date_time_day_yr, j.time_day_week AS invoice_date_time_day_week, e.hms_time AS event_start_date_hms_time, e.hms_military_hour_number AS event_start_date_hms_military_hour_number, e.hms_standard_hour_number AS event_start_date_hms_standard_hour_number, e.hms_minute_number AS event_start_date_hms_minute_number, e.hms_second_number AS event_start_date_hms_second_number, e.hms_standard AS event_start_date_hms_standard, e.hms_shift_number AS event_start_date_hms_shift_number, ee.hms_time AS event_end_date_hms_time, ee.hms_military_hour_number AS event_end_date_hms_military_hour_number, ee.hms_standard_hour_number AS event_end_date_hms_standard_hour_number, ee.hms_minute_number AS event_end_date_hms_minute_number, ee.hms_second_number AS event_end_date_hms_second_number, ee.hms_standard AS event_end_date_hms_standard, ee.hms_shift_number AS event_end_date_hms_shift_number, b.account_caption, b.account_id, b.account_name, b.account_number, b.account_type, b.account_type_desc, b.account_status_id, b.account_status, b.account_status_desc, b.account_sla_type, b.account_sla_type_desc, b.account_business_type_id, b.account_business_type, b.account_business_type_desc, b.account_team_name, b.account_manager_contact_id, b.account_manager, b.account_bdc_contact_id, b.account_bdc, b.account_primary_contact_id, b.account_primary_contact, b.account_first_server_online, b.account_tenure_days, b.account_backup_device_count, b.account_storage_device_count, b.account_other_network_device_count, b.account_server_count, b.account_unknown_device_count, b.account_all_device_count, b.account_region, b.account_geographic_location, b.account_subscription_amount, b.account_emer_instr_exists, b.account_created_date, b.account_nk, b.account_billing_street, b.account_billing_city, b.account_billing_state, b.account_billing_postal_code, b.account_billing_country, b.account_shipping_street, b.account_shipping_city, b.account_shipping_state, b.account_shipping_postal_code, b.account_shipping_country, b.account_phone, b.account_fax, b.account_website, b.account_sic, b.account_customer_type, b.account_annual_revenue, b.account_number_of_employees, b.account_ownership, b.account_ticker_symbol, b.account_description, b.account_rating, b.account_site, b.account_currency_iso_code, b.account_owner_id, b.account_source_system_name, b.account_executive_sponsor, b.account_sub_type, b.account_do_not_call, b.account_do_not_email, b.account_do_not_mail, b.account_ispartner, b.account_high_profile_flag, b.account_has_unmetered_backup, b.account_is_parent, b.account_parent_id, b.account_promotion_code, b.account_comped_flag, b.account_last_billed_date, b.account_desired_billing_day, b.customer_number, b.account_service_level, b.account_type_level2, b.account_bizspark_flag, b.account_lead_tech, b.cross_platform_lead_tech, b.account_service_level_name, b.account_service_type, b.account_service_level_datetime, f.product_usage_ssk, f.product_usage_nk, f.rate_tag AS product_usage_rate_tag, f.product_usage_name_by_tag, f.product_usage_type, f.product_usage_obj_type, f.account_obj_type, f.product_usage_name, f.product_usage_code, f.product_usage_description, f.product_usage_permitted, f.item_type, f.item_gl_segment, f.product_usage_creation_date, f.product_usage_updated_date, f.source_system_name AS product_source_system_name, c.instance_nk, c.instance_type, c.assigned_instance_number, c.assigned_account_number, c.instance_name, c.instance_description, c.instance_status, c.instance_datacenter, c.instance_creation_date, c.instance_updated_date, c.source_system_name AS instance_source_system_name, c.extended_table_name AS instance_extended_table_name, d.server_host_name AS instance_extended_server_host_name, d.server_flavor AS instance_extended_server_flavor, d.server_options AS instance_extended_server_options, d.managed_flag AS instance_extended_managed_flag, d.backup_flag AS instance_extended_backup_flag, d.cpu_count AS instance_extended_cpu_count, d.cpu_core_count AS instance_extended_cpu_core_count, d.ram_amount AS instance_extended_ram_amount, d.storage_amount AS instance_extended_storage_amount, d.bandwidth_amount AS instance_extended_bandwidth_amount, d.unit_amount AS instance_extended_unit_amount, d.operating_system AS instance_extended_operating_system, d.database_option AS instance_extended_database_option, d.created_date AS instance_extended_created_date, d.updated_date AS instance_extended_updated_date, d.source_system_name AS instance_extended_source_system_name, h.team_id, h.team_name, h.team_description, h.team_report_header, h.team_role_id, h.team_active, h.team_data_source, h.team_business_segment, h.team_business_sub_segment, h.team_company, h.team_division, g.source_system_name, l.unit_of_measure_name AS local_currency_name, l.unit_of_measure_description AS local_currency_decription, l.unit_of_measure_abbreviation AS local_currency_abbreviation, m.unit_of_measure_name AS bandwidth_unit_of_measure_name, m.unit_of_measure_description AS bandwidth_unit_of_measure_decription, a.brm_ssk, a.usl_ssk, a.dollar_amount, a.local_currency, a.quantity, a.start_time_key
                  FROM billing_events.fact_billing_events_detail_201403 a
             JOIN dim_repo.dim_account b ON a.account_key = b.account_key
        JOIN dim_repo.dim_instance c ON a.instance_key = c.instance_key
   JOIN dim_repo.dim_extended_cloud_server d ON a.extended_instance_key = d.extended_key
  JOIN dim_repo.dim_hour_min_sec e ON a.start_hms_key = e.hms_key
  JOIN dim_repo.dim_hour_min_sec ee ON a.end_hms_key = ee.hms_key
  JOIN dim_repo.dim_product_usage f ON a.product_usage_key::numeric = f.product_usage_key
  JOIN dim_repo.dim_source_system g ON a.source_system_key = g.source_system_key
  JOIN dim_repo.dim_team h ON a.team_key = h.team_key
  JOIN dim_repo.dim_time i ON a.start_time_key = i.time_key
  JOIN dim_repo.dim_time j ON a.billing_cycle_dom_key = j.time_key
  JOIN dim_repo.dim_time k ON a.end_time_key = k.time_key
  JOIN dim_repo.dim_unit_of_measure l ON a.uom_currency_type_key = l.unit_of_measure_key
  JOIN dim_repo.dim_unit_of_measure m ON a.uom_bandwidth_key = m.unit_of_measure_key)
UNION ALL 
        SELECT i.time_full_date AS event_start_date_time_full_date, i.time_day_number AS event_start_date_time_day_number, i.time_day_of_week AS event_start_date_time_day_of_week, i.time_month_number AS event_start_date_time_month_number, i.time_month_desc AS event_start_date_time_month_desc, i.time_month_abbr AS event_start_date_time_month_abbr, i.time_year_number AS event_start_date_time_year_number, i.time_quarter_number AS event_start_date_time_quarter_number, i.time_quarter_desc AS event_start_date_time_quarter_desc, i.time_business_day_number AS event_start_date_time_business_day_number, i.time_year_month_key AS event_start_date_time_year_month_key, i.time_last_day_month_flag AS event_start_date_time_last_day_month_flag, i.time_week_year_number AS event_start_date_time_week_year_number, i.time_week_month_number AS event_start_date_time_week_month_number, i.time_day_yr AS event_start_date_time_day_yr, i.time_day_week AS event_start_date_time_day_week, k.time_full_date AS event_end_date_time_full_date, k.time_day_number AS event_end_date_time_day_number, k.time_day_of_week AS event_end_date_time_day_of_week, k.time_month_number AS event_end_date_time_month_number, k.time_month_desc AS event_end_date_time_month_desc, k.time_month_abbr AS event_end_date_time_month_abbr, k.time_year_number AS event_end_date_time_year_number, k.time_quarter_number AS event_end_date_time_quarter_number, k.time_quarter_desc AS event_end_date_time_quarter_desc, k.time_business_day_number AS event_end_date_time_business_day_number, k.time_year_month_key AS event_end_date_time_year_month_key, k.time_last_day_month_flag AS event_end_date_time_last_day_month_flag, k.time_week_year_number AS event_end_date_time_week_year_number, k.time_week_month_number AS event_end_date_time_week_month_number, k.time_day_yr AS event_end_date_time_day_yr, k.time_day_week AS event_end_date_time_day_week, j.time_full_date AS invoice_date_time_full_date, j.time_day_number AS invoice_date_time_day_number, j.time_day_of_week AS invoice_date_time_day_of_week, j.time_month_number AS invoice_date_time_month_number, j.time_month_desc AS invoice_date_time_month_desc, j.time_month_abbr AS invoice_date_time_month_abbr, j.time_year_number AS invoice_date_time_year_number, j.time_quarter_number AS invoice_date_time_quarter_number, j.time_quarter_desc AS invoice_date_time_quarter_desc, j.time_business_day_number AS invoice_date_time_business_day_number, j.time_year_month_key AS invoice_date_time_year_month_key, j.time_last_day_month_flag AS invoice_date_time_last_day_month_flag, j.time_week_year_number AS invoice_date_time_week_year_number, j.time_week_month_number AS invoice_date_time_week_month_number, j.time_day_yr AS invoice_date_time_day_yr, j.time_day_week AS invoice_date_time_day_week, e.hms_time AS event_start_date_hms_time, e.hms_military_hour_number AS event_start_date_hms_military_hour_number, e.hms_standard_hour_number AS event_start_date_hms_standard_hour_number, e.hms_minute_number AS event_start_date_hms_minute_number, e.hms_second_number AS event_start_date_hms_second_number, e.hms_standard AS event_start_date_hms_standard, e.hms_shift_number AS event_start_date_hms_shift_number, ee.hms_time AS event_end_date_hms_time, ee.hms_military_hour_number AS event_end_date_hms_military_hour_number, ee.hms_standard_hour_number AS event_end_date_hms_standard_hour_number, ee.hms_minute_number AS event_end_date_hms_minute_number, ee.hms_second_number AS event_end_date_hms_second_number, ee.hms_standard AS event_end_date_hms_standard, ee.hms_shift_number AS event_end_date_hms_shift_number, b.account_caption, b.account_id, b.account_name, b.account_number, b.account_type, b.account_type_desc, b.account_status_id, b.account_status, b.account_status_desc, b.account_sla_type, b.account_sla_type_desc, b.account_business_type_id, b.account_business_type, b.account_business_type_desc, b.account_team_name, b.account_manager_contact_id, b.account_manager, b.account_bdc_contact_id, b.account_bdc, b.account_primary_contact_id, b.account_primary_contact, b.account_first_server_online, b.account_tenure_days, b.account_backup_device_count, b.account_storage_device_count, b.account_other_network_device_count, b.account_server_count, b.account_unknown_device_count, b.account_all_device_count, b.account_region, b.account_geographic_location, b.account_subscription_amount, b.account_emer_instr_exists, b.account_created_date, b.account_nk, b.account_billing_street, b.account_billing_city, b.account_billing_state, b.account_billing_postal_code, b.account_billing_country, b.account_shipping_street, b.account_shipping_city, b.account_shipping_state, b.account_shipping_postal_code, b.account_shipping_country, b.account_phone, b.account_fax, b.account_website, b.account_sic, b.account_customer_type, b.account_annual_revenue, b.account_number_of_employees, b.account_ownership, b.account_ticker_symbol, b.account_description, b.account_rating, b.account_site, b.account_currency_iso_code, b.account_owner_id, b.account_source_system_name, b.account_executive_sponsor, b.account_sub_type, b.account_do_not_call, b.account_do_not_email, b.account_do_not_mail, b.account_ispartner, b.account_high_profile_flag, b.account_has_unmetered_backup, b.account_is_parent, b.account_parent_id, b.account_promotion_code, b.account_comped_flag, b.account_last_billed_date, b.account_desired_billing_day, b.customer_number, b.account_service_level, b.account_type_level2, b.account_bizspark_flag, b.account_lead_tech, b.cross_platform_lead_tech, b.account_service_level_name, b.account_service_type, b.account_service_level_datetime, f.product_usage_ssk, f.product_usage_nk, f.rate_tag AS product_usage_rate_tag, f.product_usage_name_by_tag, f.product_usage_type, f.product_usage_obj_type, f.account_obj_type, f.product_usage_name, f.product_usage_code, f.product_usage_description, f.product_usage_permitted, f.item_type, f.item_gl_segment, f.product_usage_creation_date, f.product_usage_updated_date, f.source_system_name AS product_source_system_name, c.instance_nk, c.instance_type, c.assigned_instance_number, c.assigned_account_number, c.instance_name, c.instance_description, c.instance_status, c.instance_datacenter, c.instance_creation_date, c.instance_updated_date, c.source_system_name AS instance_source_system_name, c.extended_table_name AS instance_extended_table_name, d.server_host_name AS instance_extended_server_host_name, d.server_flavor AS instance_extended_server_flavor, d.server_options AS instance_extended_server_options, d.managed_flag AS instance_extended_managed_flag, d.backup_flag AS instance_extended_backup_flag, d.cpu_count AS instance_extended_cpu_count, d.cpu_core_count AS instance_extended_cpu_core_count, d.ram_amount AS instance_extended_ram_amount, d.storage_amount AS instance_extended_storage_amount, d.bandwidth_amount AS instance_extended_bandwidth_amount, d.unit_amount AS instance_extended_unit_amount, d.operating_system AS instance_extended_operating_system, d.database_option AS instance_extended_database_option, d.created_date AS instance_extended_created_date, d.updated_date AS instance_extended_updated_date, d.source_system_name AS instance_extended_source_system_name, h.team_id, h.team_name, h.team_description, h.team_report_header, h.team_role_id, h.team_active, h.team_data_source, h.team_business_segment, h.team_business_sub_segment, h.team_company, h.team_division, g.source_system_name, l.unit_of_measure_name AS local_currency_name, l.unit_of_measure_description AS local_currency_decription, l.unit_of_measure_abbreviation AS local_currency_abbreviation, m.unit_of_measure_name AS bandwidth_unit_of_measure_name, m.unit_of_measure_description AS bandwidth_unit_of_measure_decription, a.brm_ssk, a.usl_ssk, a.dollar_amount, a.local_currency, a.quantity, a.start_time_key
          FROM billing_events.fact_billing_events_detail_201409 a
     JOIN dim_repo.dim_account b ON a.account_key = b.account_key
  JOIN dim_repo.dim_instance c ON a.instance_key = c.instance_key
  JOIN dim_repo.dim_extended_cloud_server d ON a.extended_instance_key = d.extended_key
  JOIN dim_repo.dim_hour_min_sec e ON a.start_hms_key = e.hms_key
  JOIN dim_repo.dim_hour_min_sec ee ON a.end_hms_key = ee.hms_key
  JOIN dim_repo.dim_product_usage f ON a.product_usage_key::numeric = f.product_usage_key
  JOIN dim_repo.dim_source_system g ON a.source_system_key = g.source_system_key
  JOIN dim_repo.dim_team h ON a.team_key = h.team_key
  JOIN dim_repo.dim_time i ON a.start_time_key = i.time_key
  JOIN dim_repo.dim_time j ON a.billing_cycle_dom_key = j.time_key
  JOIN dim_repo.dim_time k ON a.end_time_key = k.time_key
  JOIN dim_repo.dim_unit_of_measure l ON a.uom_currency_type_key = l.unit_of_measure_key
  JOIN dim_repo.dim_unit_of_measure m ON a.uom_bandwidth_key = m.unit_of_measure_key;
